---
import "../../styles/global.css";
import "../../styles/style.css";
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/Header.astro";
import Collage from "../../components/Collage.astro";
import Footer from "../../components/Footer.astro";
import Get_inspried from "../../components/Get_inspired.astro";

export async function getStaticPaths() {
  const response = await fetch("https://kcyafdrxhdqxjputqjxa.supabase.co/rest/v1/product_items", {
    method: "GET",
    headers: {
      apikey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtjeWFmZHJ4aGRxeGpwdXRxanhhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTY1NDgyNjgsImV4cCI6MjAzMjEyNDI2OH0.Ds4oUM3yPKNH5mMMKKLDh3QmQ1iTPuS-sqllkSvXaY4",
    },
  });
  const data = await response.json();

  const newData = data.map((product) => {
    return { params: { slug: product.slug }, props: { data: product } };
  });

  //console.log(newData);
  return newData;
}

const { id } = Astro.params;
const { data } = Astro.props;
console.log(data);
---

<Layout title="PanicHood">
  <Header />
  <main class="product-page">
    <p><a href="">Home</a> / <a href="">Products</a> / <a href="">{data.name}</a></p>
    <div class="grid1_1">
      <img src={data.front} alt="tee1_front" class="tee1_front" />
      <div class="text">
        <div class="panic_dealer_tee">
          <h1 class="h1">{data.name}</h1>
        </div>
        <h3 class="pris">{data.price} DKK</h3>
        <p class="beskrivelse">
          {data.discription}
        </p>
        <div class="container">
          <div class="size-selector">
            <label>SIZE</label>
            <div class="sizes">
              <button class="size" data-size="S">S</button>
              <button class="size" data-size="M">M</button>
              <button class="size" data-size="L">L</button>
              <button class="size" data-size="XL">XL</button>
            </div>
          </div>
          <div class="quantity-selector">
            <button id="decrease">-</button>
            <span id="quantity">1</span>
            <button id="increase">+</button>
          </div>
          <button id="add-to-cart">ADD TO CART</button>
        </div>
      </div>
    </div>
    <img src="../../public/img/sizechart.webp" alt="sizechart" class="sizechart" />
    <Get_inspried />
  </main>
  <Footer />
</Layout>

<style>
  main {
    padding: 4rem;
  }
  a {
    text-decoration: none;
    color: var(--oliveGrey);
  }
  img {
    width: 80%;
  }
  h1 {
    font-size: 3rem;
    margin: 0%;
  }
  .grid1_1 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    margin-top: 10%;
  }
  .beskrivelse {
    margin-top: 5%;
  }
  .sizechart {
    margin-top: 10%;
    width: 102%;
    border: 1px solid black; /* Ændr bredden efter behov */
  }
  .tee1_front {
    margin-bottom: 20%;
  }
  .pris {
    margin-top: 10%;
  }
  .container {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 10px;
  }

  .size-selector label {
    font-weight: bold;
  }

  .sizes {
    display: flex;
    gap: 23px;
  }

  .size {
    padding: 13px;
    border: 1px solid #000;
    background-color: #fff;
    cursor: pointer;
  }

  .size.selected {
    background-color: #073F9C;
    color: #fff;
  }

  .quantity-selector {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .quantity-selector button {
    padding: 13px;
    border: 1px solid #000;
    background-color: #fff;
    cursor: pointer;
  }

  #add-to-cart {
    padding: 13px 10px;
    background-color: #073F9C;
    color: #fff;
    border: none;
    cursor: pointer;
   position: relative;
   top: -55px;
   left: 125px;
    
    
  }

  #add-to-cart:hover {
    background-color: #073F9C;
  }

  @media (max-width: 800px) {
    main {
      padding: 2rem; /* Mindre padding for mindre skærme */
    }
    img {
      width: 100%; /* Fyld hele bredden på mindre skærme */
    }

    .product-page .grid1_1 {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .product-page .grid1_1 .panic_dealer_tee {
      order: -1; /* Sørg for at denne er først */
    }

    .product-page .grid1_1 .tee1_front {
      order: 1; /* Sørg for at billedet er nummer 2 */
      margin-bottom: 2rem; /* Juster margin for bedre spacing */
      width: 100%;
    }

    .product-page .grid1_1 .text {
      order: 2; /* Sørg for at tekst div er nummer 3 */
      width: 100%;
      text-align: center; /* Centrer tekst for bedre læsbarhed */
    }

    .sizechart {
      width: 100%;
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    let selectedSize = null;
    const sizes = document.querySelectorAll(".size");
    sizes.forEach((size) => {
      size.addEventListener("click", function () {
        sizes.forEach((s) => s.classList.remove("selected"));
        size.classList.add("selected");
        selectedSize = size.getAttribute("data-size");
      });
    });

    let quantity = 1;
    const quantityElement = document.getElementById("quantity");
    document.getElementById("decrease").addEventListener("click", function () {
      if (quantity > 1) {
        quantity--;
        quantityElement.textContent = quantity;
      }
    });
    document.getElementById("increase").addEventListener("click", function () {
      quantity++;
      quantityElement.textContent = quantity;
    });
  });
</script>
